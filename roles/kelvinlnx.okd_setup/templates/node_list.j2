{%- set net_portion=a_result.get_xml|regex_search("ip.*address='(([0-9]{1,3}\.){3}).*'","\\1") | first -%}
node_list:
- name: bootstrap
  ip: {{ net_portion }}2
  mac: {{ ( net_portion + '100' )|hash('md5')|regex_replace("^(..)(..)(..).*$","52:54:00:\\1:\\2:\\3") }}
{% for value in range(0,3) %}
- name: master{{ value }}
  ip: {{ net_portion }}{{ value + 10 }}
  mac: {{ ( net_portion + ( value+10 ) | string ) | hash('md5') | regex_replace("^(..)(..)(..).*$","52:54:00:\\1:\\2:\\3") }}
{% endfor %}